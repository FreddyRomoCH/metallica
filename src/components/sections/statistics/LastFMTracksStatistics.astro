---
import LogoLastFM from "../../Logos/LogoLastFM.astro";
import { lastFMGetTopSongs } from "../../../services/lastfm-get-top-songs";

let topSongs;
try {
  topSongs = await lastFMGetTopSongs();
  //albumsImg = await lastFMGetAlbumsImg(topSongs);
} catch (error) {
  console.error("Failed to fetch artist info:", error);
  topSongs = null;
}

interface props {
  area: string;
}

const { area, title } = Astro.props;
---

<section class=`[grid-area:${area}] box-border p-3`>
  <header
    class="flex flex-row justify-center items-center gap-2 mb-8 text-center"
  >
    <span>
      <LogoLastFM />
    </span>
    <h2 class="font-semibold text-lg">{title}</h2>
  </header>
  {
    topSongs ? (
      topSongs.toptracks.track.map((song) => {
        return (
          <div class="flex flex-row items-center justify-start gap-2 mb-4">
            <picture class="relative w-8 h-8">
              <img src={song.albumImage} alt={song.name} />
            </picture>
            <h2 class="truncate">{song.name}</h2>
          </div>
        );
      })
    ) : (
      <h2>Top songs could not be loaded</h2>
    )
  }
</section>
